<div id="<%=tabNode%>">
    {{message}}
</div>
<script type="text/javascript">
    registerModule('<%=tabModule%>', function (module) {
        module.instanceCount = 0;
        module.ready = function (appId) {
            var appInstance = module.registerApp(appId, { instanceId: ++ module.instanceCount },
                function (app) {
                app.ready = function () {
                    angular.module('tabsApp').controller('<%=tabController%>', function ($scope) {
                        $scope.message = 'Hello there !!';
                        // $scope.$apply();
                    });
                    var $injector = angular.injector(['ng', 'tabsApp']);
                    var element = $('#<%=tabNode%>');
                    element.attr({'ng-controller': '<%=tabController%>'});

                    $injector.invoke(function($rootScope, $compile) {
                        $compile(element[0])($rootScope);
                        $rootScope.$digest();
                        corelib.log('<%=tabModule%>', 'loaded');
                    });
                };
                app.dispose = function () {

                };
            });
            appInstance.ready();
        };
        module.dispose = function (appId) {
            if (appId) {
                module.apps[appId].dispose();
                delete module.apps[appId];
            } else {
                module.destruct();
            }
        };
    }).ready();
</script>